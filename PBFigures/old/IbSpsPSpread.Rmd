Load the libraries
```{r}
library(nat)
library(neuprintr)
library(neuprintrExtra)
library(dplyr)
library(ggplot2)
library(cowplot)
```

Get the neuronBag for the IbSpsP neurons
```{r}
IbSpsPBag <- neuronBag(getTypesTable(c('IbSpsP')))
```

Select the outputs in specific PB glomeruli
```{r}
IbSpsPGlomOuts <- IbSpsPBag$outputs_raw
IbSpsPGlomOuts <- IbSpsPGlomOuts[grepl('PB\\(',IbSpsPGlomOuts$roi),]
IbSpsPGlomOuts$glom <- IbSpsPGlomOuts$roi %>% lapply(function(x) sub("\\).*","",sub(".*\\(","",x))) %>% unlist()
```

Plot the synapses per glomeruli
```{r, fig.width=8, fig.height = 8}
ggplot(IbSpsPGlomOuts) + geom_bar(aes(x=as.factor(glom),y=ROIweight,fill=name.from),stat='identity') +
  facet_grid(rows = vars(name.from)) + 
  theme_cowplot() + scale_y_continuous(breaks=c(0,2000)) +
  theme(strip.text.y = element_blank())
```
