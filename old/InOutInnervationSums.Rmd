---
title: "Inputs/outputs high level summary numbers"
output: html_notebook
---

```{r message=FALSE, warning=FALSE}
library(neuprintr)
library(tidyverse)
library(neuprintrExtra)
library(nat)
library(tidygraph)
library(Matrix)
library(igraph)
library(paletteer)
library(cowplot)
```
# Prelims
```{r message=FALSE}
source("../outputsFig/outputFunctions-core.R")
source("../outputsFig/outputFunctions-display.R")
source("../R/table2ggraphUtils.R")
outputsFolder <- "~/Dropbox (HHMI)/FIBSEM CX Paper Jan 2020/Figures/NewOutputs/"
```

```{r}
load("inputsBasics.RData")
load("outputsBasics.RData")
```




```{r}
outputTotals <- ggplot(filter(CXOutsideInnervationSummary,downstreamRatio>0.01 & totalDownstream>200),aes(x=roi,y=totalDownstream)) + geom_point() + facet_wrap(.~region,scales="free") + theme_paper_grid() + theme(axis.text.x = element_text(angle=90,hjust = 1,vjust=0.5))+ ylab("total # of output synapses")
outputTotals
```

```{r}
save_plot(paste0(outputsFolder,"inputsAll.svg"),inputTotals,base_width=6,base_height = 4)
save_plot(paste0(outputsFolder,"outputsAll.svg"),outputTotals,base_width=6,base_height = 4)
```

```{r}
CXInSyn <- readRDS("CX-outsideSynapses_Inputs.rds")
displayAnatomies(synapses=CXInSyn,
                 ROIs=c("EB","FB","PB","NO","LAL(R)","BU(R)","CRE(R)","SMP(R)","WED(R)","SLP(R)","SIP(R)","SPS(R)","IPS(R)"),
                 saveName = "allIns",
                 synapsePalette = supertype3Palette,
                 synapseCluster = "supertype3",
                 size = c(3000,3000))


```



